<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Spring-JDBC | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="JDBC(Java Database Connectivity)JDBC란? JDBC는 DBMS와의 연동을 위해 제공되는 자바 표준 API(java.sql) 이다.    JDBC 드라이버  Java.sql 패키지의 interface를 구현한 클래스를 드라이버라고 한다.    데이터베이스가 달라졌을 때 SQL은 DB에 맞게 수정해야 한다. 커넥션도 DB에 따라 다를">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring-JDBC">
<meta property="og:url" content="https://limjoonchul.github.io/2020/11/21/Spring/JDBC/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="JDBC(Java Database Connectivity)JDBC란? JDBC는 DBMS와의 연동을 위해 제공되는 자바 표준 API(java.sql) 이다.    JDBC 드라이버  Java.sql 패키지의 interface를 구현한 클래스를 드라이버라고 한다.    데이터베이스가 달라졌을 때 SQL은 DB에 맞게 수정해야 한다. 커넥션도 DB에 따라 다를">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://limjoonchul.github.io/Java/documents/images/JDBC.jpg">
<meta property="og:image" content="https://limjoonchul.github.io/Java/documents/images/jdbcdriver.jpg">
<meta property="og:image" content="https://limjoonchul.github.io/Java/documents/images/JDBC%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC.jpg">
<meta property="og:image" content="https://limjoonchul.github.io/Java/documents/images/JDBC%EA%B5%AC%EC%A1%B0.png">
<meta property="og:image" content="https://limjoonchul.github.io/Java/documents/images/ResultSet.jpg">
<meta property="article:published_time" content="2020-11-21T05:59:49.979Z">
<meta property="article:modified_time" content="2020-11-21T06:01:32.886Z">
<meta property="article:author" content="Facamp lim">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://limjoonchul.github.io/Java/documents/images/JDBC.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.0.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://limjoonchul.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Spring/JDBC" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/11/21/Spring/JDBC/" class="article-date">
  <time datetime="2020-11-21T05:59:49.979Z" itemprop="datePublished">2020-11-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Spring-JDBC
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="JDBC-Java-Database-Connectivity"><a href="#JDBC-Java-Database-Connectivity" class="headerlink" title="JDBC(Java Database Connectivity)"></a>JDBC(Java Database Connectivity)</h1><h2 id="JDBC란"><a href="#JDBC란" class="headerlink" title="JDBC란?"></a>JDBC란?</h2><ul>
<li>JDBC는 DBMS와의 연동을 위해 제공되는 자바 표준 API(java.sql) 이다.</li>
</ul>
<p><img src="/Java/documents/images/JDBC.jpg" alt="JDBC"></p>
<ul>
<li><p>JDBC 드라이버</p>
<ul>
<li>Java.sql 패키지의 interface를 구현한 클래스를 드라이버라고 한다.</li>
</ul>
<p><img src="/Java/documents/images/jdbcdriver.jpg" alt="JDBCDriver"></p>
</li>
<li><p>데이터베이스가 달라졌을 때 SQL은 DB에 맞게 수정해야 한다. 커넥션도 DB에 따라 다를 수 밖에 없음.<br>나머지 자바코드는 DB와 상관 없이 재사용 가능하다.</p>
</li>
<li><p>DB연동할 때 java.sql 패키지 클래스나 인터페이스를 이용해야한다. 인터페이스가 훨씬 많다.</p>
</li>
<li><p>인터페이스가 많다는건 jdbc도 내부적으로 다형성을 이용하고 있다라고 알면 된다.</p>
</li>
<li><p>특정 DB에 비 종속적인 자바코드를 유지할 수 있다.</p>
</li>
<li><p>JDBC API - java.sql 패키지, 인터페이스가 많음(리모콘) 이 인터페이스를 구현한게 JDBC Driver이다.</p>
<ul>
<li>이 드라이버는 DB벤더 개발자들이 드라이버를 개발한다. 최적화된 자바코드를 이용해서 개발한다.</li>
<li>그래서 드라이버는 db에 따라 달라질 수 있고 성능이 달라질 수 있다.</li>
<li>우리가 드라이버를 개발하는게 아니다. 그런데 여러 DB가 동일한 인터페이스를 상속했기 때문에 똑같은 메소드를 가지고 있다.</li>
<li>클라이언트가 (tv유저) 리모콘이라는 인터페이스를 통해서 오라클, mysql jdbc 드라이버인 lgtv, samsungtv가 동작한다.</li>
</ul>
</li>
<li><p>jar파일을 등록을해주면 인터페이스에 대한 구현클래스들을 확보하는 것이다(드라이버)</p>
<h3 id="JDBC-동작-원리"><a href="#JDBC-동작-원리" class="headerlink" title="JDBC 동작 원리"></a>JDBC 동작 원리</h3></li>
</ul>
<p><img src="/Java/documents/images/JDBC%EB%8F%99%EC%9E%91%EC%9B%90%EB%A6%AC.jpg" alt="JDBC동작원리"></p>
<h3 id="JDBC-구조"><a href="#JDBC-구조" class="headerlink" title="JDBC 구조"></a>JDBC 구조</h3><p><img src="/Java/documents/images/JDBC%EA%B5%AC%EC%A1%B0.png" alt="JDBC구조"></p>
<h3 id="JDBC-프로그램-절차"><a href="#JDBC-프로그램-절차" class="headerlink" title="JDBC 프로그램 절차"></a>JDBC 프로그램 절차</h3><ol>
<li><p>Driver 로딩</p>
<ul>
<li><code>DriverManager.registerDriver(new org.h2.Driver())</code>와 <code>Class.forName(&quot;org.h2.Driver&quot;)</code> 차이<ul>
<li><code>DriverManager.registerDriver(new org.h2.Driver())</code><ul>
<li>이것을 이용하면 이 클래스가 패키지에 없으면 아예 컴파일부터 안된다.</li>
<li>실행하기도 전에 클래스패스상에 존재하지 않는다고 인식한다. 그래서 h2 라이브러리를 등록을해줘야 한다.</li>
</ul>
</li>
<li><code>Class.forName(&quot;org.h2.Driver&quot;)</code><ul>
<li>문자열로 등록하는 방법 결과는 같음. 실제 프로젝트에선 간결해서 이걸 더 많이 쓴다.</li>
<li>문자열로 클래스경로를 찾아주면 똑같이 메모리 주소를 생성해서 올린다.</li>
<li>클래스이름에 오타가 있어도 컴파일이 되 버린다. 그래서 실행을 할 때 문제가 있다는걸 실행할 때 알려준다.</li>
<li>라이브러리가 없는데도 컴파일이 되버린다. 하지만 실행을 하면 h2관련 드라이버가 없으니깐 에러가 난다.</li>
</ul>
</li>
</ul>
</li>
<li>jar파일 안에서 org.h2 driver.class가 중요하다. new org.h2.Driver()를 등록한다.<ul>
<li>이걸 등록해서 연결할 때 h2드라이버로 연결을 해주는 것이다.</li>
</ul>
</li>
</ul>
</li>
<li><p>Connection 연결</p>
<ul>
<li>커넥션 획득할 때는 url, 아이디, 비밀번호가 일치해야한다.<ul>
<li>다른사람의 DB에 연결하고 싶을 때, 다른 사람의 IP주소를 세팅하면 된다.</li>
<li>IP주소는 유니크하기 때문에 로컬호스트는 유니크한것이다. 위에 url은 내 컴퓨터에 있는 h2데이터베이스와 연결한다는 것이다.</li>
<li>JDBC URL은 드라이버마다 다르다. JDBC URL은 DB 설치한 사람(DB관리자)한테 물어보면 된다.</li>
</ul>
</li>
</ul>
</li>
<li><p>Statement 생성</p>
</li>
<li><p>SQL 명령어 전송</p>
<ul>
<li>SQL을 담아서 DBMS로 보내는 작업이다.</li>
<li>INSERT, DELETE, UPDATE는 전송하는 메소드가 <code>executeUpdate()</code>로 같다.</li>
<li>SELECT는 <code>executeQuery()</code> 이다.</li>
</ul>
</li>
<li><p>검색 결과 처리(INSERT, UPDATE, DELETE 작업에서는 생략)</p>
</li>
<li><p>Connection 연결 해제</p>
</li>
</ol>
<ul>
<li>어디에 적용해도 1,2,3 번은 똑같다.</li>
</ul>
<h4 id="INSERT-DELETE-UPDATE-구현-예"><a href="#INSERT-DELETE-UPDATE-구현-예" class="headerlink" title="INSERT, DELETE, UPDATE 구현 예"></a>INSERT, DELETE, UPDATE 구현 예</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InsertBoardTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1. 드라이버 객체를 메모리에 로딩한다.</span></span><br><span class="line">            <span class="comment">// DriverManager.registerDriver(new org.h2.Driver()); // 애를이용하면 이 클래스가 패키지에 없으면 아예 컴파일부터 안된다.</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 드라이버 매니저를 통해 특정 드라이버를 메모리에 올려야한다.</span></span><br><span class="line">            <span class="comment">// 우린 h2 드라이버를 메모리 로딩해야한다 그래야 이 드라이버로부터 연결을 얻을 수 있고</span></span><br><span class="line">            <span class="comment">// 연결로부터 스테이트먼트 클래스를 얻을 수 있다.</span></span><br><span class="line">            <span class="comment">// jar파일안에서 org.h2 driver.class가중요하다. new org.h2.Driver()를 등록한다</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 위아래는 기능적으로는 결과는 똑같지만, 특징들을 작성한 차이가 있다.</span></span><br><span class="line">            Class.forName(<span class="string">&quot;org.h2.Driver&quot;</span>); <span class="comment">// 문자열로 등록하는 방법 결과는 같음. 실제프로젝트에선 이걸 더 많이 씀 간결해서</span></span><br><span class="line">           </span><br><span class="line">            <span class="comment">// 2. 커넥션을 획득한다.</span></span><br><span class="line">            String url = <span class="string">&quot;jdbc:h2:tcp://localhost/~/test&quot;</span>;</span><br><span class="line">            conn = DriverManager.getConnection(url, <span class="string">&quot;sa&quot;</span>, <span class="string">&quot;&quot;</span>);<span class="comment">// 연결 객체를 반환받는다.</span></span><br><span class="line">           </span><br><span class="line">            <span class="comment">// 3. SQL전달 객체(Statement)를 생성한다.</span></span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4. SQL을 전송한다.</span></span><br><span class="line">            String sql = <span class="string">&quot;insert into board(seq, title, writer, content) values(3, &#x27;테스트 제목&#x27;, &#x27;테스터&#x27;, &#x27;테스트 내용...&#x27;)&quot;</span>;</span><br><span class="line">            <span class="comment">// String sql = &quot;insert into board(seq, title, writer, content) values((select nvl(max(seq), 0) + 1 from board), &#x27;테스트 제목&#x27;, &#x27;테스터&#x27;, &#x27;테스트 내용...&#x27;)&quot;;</span></span><br><span class="line">            <span class="comment">// null 에대한 비교연산은 false이다 비교를 못함</span></span><br><span class="line">            <span class="comment">// select nvl(max(seq), 0) + 1 from board; nvl은 nonvalue에 약자 최대값이 null이 나오면 0 으로 바꾸라는 의미</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> cnt = stmt.executeUpdate(sql); <span class="comment">// dbms에 전송한다</span></span><br><span class="line">            System.out.println(cnt + <span class="string">&quot;건의 데이터 처리 성공!&quot;</span>);</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">           <span class="comment">// 등록 수정 삭제는 resultset을 사용하지 않기 때문에 stmt, conn만 닫아주면 된다.</span></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)</span><br><span class="line">                 stmt.close();</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                stmt = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">              <span class="keyword">if</span>(!conn.isClosed() &amp;&amp; conn != <span class="keyword">null</span>) <span class="comment">// 커넥션이 닫힌게 아니라면 이조건을 실행해라.</span></span><br><span class="line">                 conn.close();</span><br><span class="line"></span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                conn = <span class="keyword">null</span>;</span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="SELECT-구현-예"><a href="#SELECT-구현-예" class="headerlink" title="SELECT 구현 예"></a>SELECT 구현 예</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetBoardListTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>;</span><br><span class="line">        Statement stmt = <span class="keyword">null</span>;</span><br><span class="line">        ResultSet rs = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1. 드라이버 객체를 메모리에 로딩한다.</span></span><br><span class="line">            <span class="comment">// DriverManager.registerDriver(new org.h2.Driver()); // 애를 이용하면 이 클래스가 패키지에 없으면 아예 컴파일부터 안된다.</span></span><br><span class="line"></span><br><span class="line">            Class.forName(<span class="string">&quot;org.h2.Driver&quot;</span>); <span class="comment">// 문자열로 등록하는 방법 결과는 같음. 실제프로젝트에선 이걸 더 많이 씀 간결해서</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 2. 커넥션을 획득한다.</span></span><br><span class="line">            String url = <span class="string">&quot;jdbc:h2:tcp://localhost/~/test&quot;</span>;</span><br><span class="line">            conn = DriverManager.getConnection(url, <span class="string">&quot;sa&quot;</span>, <span class="string">&quot;&quot;</span>);<span class="comment">// 연결 객체를 반환받는다.</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 3. SQL전달 객체(Statement)를 생성한다.</span></span><br><span class="line">            stmt = conn.createStatement();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 4. SQL을 전송한다.</span></span><br><span class="line">            String sql = <span class="string">&quot;select * from board order by seq desc&quot;</span>;</span><br><span class="line">            rs = stmt.executeQuery(sql); <span class="comment">// select 전용 메소드 rs으로 반환함. 결과 집합</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 5. 검색 결과 처리(SELECT 구문에 한하여 해당된다.)</span></span><br><span class="line">            System.out.println(<span class="string">&quot;[ BOARD LIST ]&quot;</span>);</span><br><span class="line">            <span class="keyword">while</span> (rs.next())&#123;</span><br><span class="line">                System.out.println(rs.getInt(<span class="string">&quot;SEQ&quot;</span>) + <span class="string">&quot; : &quot;</span>);</span><br><span class="line">                System.out.println(rs.getString(<span class="string">&quot;TITLE&quot;</span>) + <span class="string">&quot; : &quot;</span>);</span><br><span class="line">                System.out.println(rs.getString(<span class="string">&quot;WRITER&quot;</span>) + <span class="string">&quot; : &quot;</span>);</span><br><span class="line">                System.out.println(rs.getString(<span class="string">&quot;CONTENT&quot;</span>) + <span class="string">&quot; : &quot;</span>);</span><br><span class="line">                System.out.println(rs.getDate(<span class="string">&quot;REGDATE&quot;</span>) + <span class="string">&quot; : &quot;</span>);</span><br><span class="line">                System.out.println(rs.getInt(<span class="string">&quot;CNT&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">try</span>&#123;</span><br><span class="line">              <span class="keyword">if</span>(rs != <span class="keyword">null</span>)</span><br><span class="line">                  rs.close();</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line"></span><br><span class="line">            &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                rs = <span class="keyword">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">           <span class="keyword">try</span>&#123;</span><br><span class="line">              <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)</span><br><span class="line">                 stmt.close();</span><br><span class="line"></span><br><span class="line">           &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line"></span><br><span class="line">           &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">               stmt = <span class="keyword">null</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">try</span>&#123;</span><br><span class="line">             <span class="keyword">if</span>(!conn.isClosed() &amp;&amp; conn != <span class="keyword">null</span>) <span class="comment">// 커넥션이 닫힌게 아니라면 이조건을 실행해라.</span></span><br><span class="line">                conn.close();</span><br><span class="line"></span><br><span class="line">           &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">               e.printStackTrace();</span><br><span class="line"></span><br><span class="line">           &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">               conn = <span class="keyword">null</span>;</span><br><span class="line">           &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>어플리케이션이 있고 DB가 있는데 문자열로된 SQL을 DBMS로 보내주는건데 어플리케이션을 서울이라고 보고 DB를 부산이라고 했을 때</li>
<li>이 SQL이 사람이라고 치면 사람이 부산까지 걸어갈 수 없으니 고속도로를 뚫어야한다 이 도로가 커넥션 서울과 부산이 연결되어 있다는 것</li>
<li>커넥션이 될려면 URL, ID, PW가 있어야 한다.  대전이랑 연결할려면 연결이 달라져야한다.</li>
<li>고속도로가 뚫려도 자동차가 필요하다 자동차가 Statement이다.</li>
<li>자동차에 사람(sql)을 태워서 부산으로 보내는게  stmt.executeUpdate(sql)이 작업이다. 이것이 jdbc이다.</li>
<li>고속도로 뚫는다 자동차를 만든다 자동차에 사람을 태워 부산으로 보낸다.</li>
</ul>
<h4 id="Result-Set"><a href="#Result-Set" class="headerlink" title="Result Set"></a>Result Set</h4><p><img src="/Java/documents/images/ResultSet.jpg" alt="Result Set"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">* Before First(as B.F), After Last(as A.L)는 데이터가 없는 칸이다. </span><br><span class="line">* B.F에 커서가 존재한다. rs.next를 호출하면 커서를 밑으로 한칸 내려준다.</span><br><span class="line">* 리턴타입이 불린이다. 읽을 데이터가 있으면 true가 되고 출력하고 아래로 내려간다.</span><br><span class="line">* 그리고 또 데이터를 출력한다. 그리고 커서가 아래로 이동한다 그럼 A.L로 이동해서</span><br><span class="line">* 읽을 값이 없어서 false 가 되서 반복문을 벗어난다.</span><br><span class="line">*</span><br><span class="line">* 반복문을 없애고 각 커서를 읽으려고 하면 데이터가 없는 영역이라고 에러가 뜬다.</span><br><span class="line">* rs.next가 실행되어야 커서가 아래로 내려가는 것이다. 그래야 하나의 로우정보를 읽을 수 있음.</span><br><span class="line">* 더이상 읽을 데이터가 없을 때까지 while문으로 rs.next를 사용하여 내려주는 것이다.</span><br><span class="line">*</span><br><span class="line">* 데이터 타입에 따라 사용하는 메소드가 달라져야한다.(getXXX()) 컬럼은 대소문자를 구분하지 않는다.</span><br><span class="line">* 중요한건 컬럼이름을 모른다면, getInt(1) 처럼 컬럼위 위치를 넣을 수 있다 그런데 이러면 가독성이 떨어짐...</span><br><span class="line">* 가급적 컬럼이름을 써라. 대소문자를 구분하진 않지만 대문자를 쓰는게 가독성 측면에서 좋다.</span><br><span class="line">* 컬럼의 순서는 안맞춰도 되지만 가급적 맞추는게 좋다.</span><br></pre></td></tr></table></figure>

<h4 id="리소스-닫기-Coonection-close"><a href="#리소스-닫기-Coonection-close" class="headerlink" title="리소스 닫기(Coonection close)"></a>리소스 닫기(Coonection close)</h4><ul>
<li>이렇게 하면 rs.close()에서 에러가 뜨면 catch 로 넘어가서 stmt, conn close()가 실행 되지 않아서 에러가 뜬다.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">      rs.close();</span><br><span class="line">      stmt.close();</span><br><span class="line">      conn.close();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>이렇게 해야 한다.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(rs != <span class="keyword">null</span>)</span><br><span class="line">        rs.close();</span><br><span class="line"></span><br><span class="line">&#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">    rs = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)</span><br><span class="line">        stmt.close();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    stmt = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!conn.isClosed() &amp;&amp; conn != <span class="keyword">null</span>) <span class="comment">// 커넥션이 닫힌게 아니라면 이조건을 실행해라.</span></span><br><span class="line">        conn.close();</span><br><span class="line"></span><br><span class="line">&#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    conn = <span class="keyword">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>입출력 스트림을 할 때 다끝나면 입출력스트림을 꼭 닫아줘야한다.</li>
<li>이 커넥션은 굉장히 중요하다. 안그러면 다른 어플리케이션에서 커넥션을 못 맺는다.</li>
<li>안 끊는다고 실행이 안되는건 아닌데 웹에서 여러명이 db연동을 하기 때문에 중요함.</li>
<li>커넥션은 커넥션 statement, resultset 순으로해서 close()를 할 때도 역순으로 닫아야 한다.</li>
<li>등록 수정 삭제는 resultset을 사용하지 않기 때문에 stmt, conn만 닫아주면 된다.</li>
</ul>
<h3 id="PreparedStatement"><a href="#PreparedStatement" class="headerlink" title="PreparedStatement"></a>PreparedStatement</h3><ul>
<li><p>Statement보다 SQL처리 속도가 5배 이상 빨라서 이걸 사용 하면 된다.</p>
</li>
<li><p>DB에서 SQL이 들어올 때 가장 먼저 확인하는 것이 문법체크와 오브젝트를 확인하는 것이다.<br>SQL이 들어올 때마다 이러한 작업들을 계속해서 수행해야 하나는데 <code>PreparedStatement</code>를 사용 하게 되면<br>한 번 SQL을 사용해서 보내 놓으면 그 다음부터는 문법체크와 오브젝트 확인에 대한 작업들을 실행하지 않는다.<br>그래서 일단 ?로 값을 채워 넣고 동적으로 setXXX()를 사용하여 값을 넣어서 사용할 수 있다.<br>문법체크와 오브젝트를 확인하는 일에 대해서 한번 이후에 계속해서 실행시키지 않기 때문에<br>속도가 더 빠른 것이다. </p>
</li>
<li><p>Statement와 차이점</p>
<ul>
<li><code>String sql = &quot;select * from users where id = ? and password = ?&quot;;</code> - 파라미터를 ?로 작성한다.</li>
<li><code>stmt = conn.prepareStatement(sql);</code> - 여기서 ()안에 sql을 넣어줘야 한다.</li>
<li><code>stmt.setString(1, &quot;admin&quot;)</code>, <code>stmt.setString(2, &quot;admin&quot;)</code> - 파라미터 ? 에 순서대로 1,2 번호를 넣고 해당하는 값을 넣는다.</li>
<li><code>rs = stmt.executeQuery();</code> - sql을 빼고 작성하면 된다.</li>
</ul>
</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.user;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.h2.util.JdbcUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rubypapper.biz.common.JDBCUtil;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetUserTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// JDBC API 선언</span></span><br><span class="line">        Connection conn = <span class="keyword">null</span>; <span class="comment">// 고속도로</span></span><br><span class="line"><span class="comment">//        Statement stmt = null; // 자동차 </span></span><br><span class="line">        PreparedStatement stmt = <span class="keyword">null</span>; <span class="comment">// 자동차(페라리) statement보다 sql처리속도가 5배 이상 빠르다. 무조건 써라.</span></span><br><span class="line">        ResultSet rs = <span class="keyword">null</span>; <span class="comment">// 검색 결과 저장</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 2.Connection 객체를 획득한다.</span></span><br><span class="line">            conn = JDBCUtil.getConnection(); <span class="comment">// static 메소드니깐 바로 접근이 가능하다.</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 3. Statement 객체를 획득한다.</span></span><br><span class="line">            String sql = <span class="string">&quot;select * from users where id = ? and password = ?&quot;</span>;</span><br><span class="line">            stmt = conn.prepareStatement(sql);<span class="comment">// 프리페얼드는 여기에 sql이 들어감 그리고 파라미터가 ?로 바뀐다. exe여기에 sql이 빠짐</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// ? 파라미터에 값  설정</span></span><br><span class="line">            stmt.setString(<span class="number">1</span>, <span class="string">&quot;admin&quot;</span>);</span><br><span class="line">            stmt.setString(<span class="number">2</span>, <span class="string">&quot;admin&quot;</span>);  <span class="comment">// 결과가 달라지는게 아니라 성능이 더 좋아진다.</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 4. SQL 구문을 DB에 전송한다.</span></span><br><span class="line">            </span><br><span class="line">            rs = stmt.executeQuery();</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 5. 검색 결과 처리</span></span><br><span class="line">            <span class="keyword">if</span>(rs.next()) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;아이디 : &quot;</span> + rs.getString(<span class="string">&quot;ID&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;비번 : &quot;</span> + rs.getString(<span class="string">&quot;PASSWORD&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;이름 : &quot;</span> + rs.getString(<span class="string">&quot;NAME&quot;</span>));</span><br><span class="line">                System.out.println(<span class="string">&quot;권한 : &quot;</span> + rs.getString(<span class="string">&quot;ROLE&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            <span class="comment">// TODO Auto-generated catch block</span></span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(rs, stmt, conn);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Refactoring"><a href="#Refactoring" class="headerlink" title="Refactoring"></a>Refactoring</h2><ul>
<li>처음엔 정말 그대로 각 클래스에서 기능을 처리하도록 만들었었는데, 이렇게 작성했을 때 유지보수성이 안좋았다.<br>그래서 다음으로 JDBCUtil로 공통적으로 사용하는 코드들을 새로운 클래스에 만들어서 호출하는 방식으로 해서 유지보수성을 높였는데,<br>거기서 더 나아가서 데이터베이스에 접근할 수 있는 DAO 클래스와 전달되는 객체 VO를 만들어서 한 번더 리팩토링을 했다.</li>
<li>순서대로 Refactoring 해가는 과정 코드들을 적었다.</li>
</ul>
<h3 id="1-JDBCUtil-클래스를-만들어서-리팩토링"><a href="#1-JDBCUtil-클래스를-만들어서-리팩토링" class="headerlink" title="1. JDBCUtil 클래스를 만들어서 리팩토링"></a>1. JDBCUtil 클래스를 만들어서 리팩토링</h3><ul>
<li>InsertBoardTest 클래스<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InertBoardTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Connection conn = <span class="keyword">null</span>; PreparedStatement stmt = <span class="keyword">null</span>;</span><br><span class="line">                  </span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">         <span class="comment">// JDBUCUtil에 1,2 번 과정이 들어가있어서 호출해서 사용.</span></span><br><span class="line">         conn = JDBCUtil.getConnection();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 3. SQL 전달 객체를 생성한다.</span></span><br><span class="line">        <span class="comment">// String sql = &quot;insert into board(seq, title, writer, content) values((select nvl(max(seq), 0) + 1 from board), ?, ?, ?)&quot;;</span></span><br><span class="line">        stmt = conn.prepareStatement(sql);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 파라미터 세팅 stmt.setString(1, &quot;JDBC 제목 &quot;); stmt.setString(2, &quot;테스터&quot;);</span></span><br><span class="line">        stmt.setString(<span class="number">3</span>, <span class="string">&quot;JDBC 내용...&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 4. SQL 전송        </span></span><br><span class="line">        <span class="keyword">int</span> cnt = stmt.executeUpdate(); </span><br><span class="line">        System.out.println(cnt + <span class="string">&quot;건의 데이터 처리 성공!&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123; </span><br><span class="line">          e.printStackTrace();</span><br><span class="line">        </span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123; </span><br><span class="line">          JDBCUtil.close(stmt, conn); </span><br><span class="line">        &#125;        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>JDBCUtil 클래스<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.common;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JDBCUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 자원 연결</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Connection <span class="title">getConnection</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 1. 드라이버 객체를 메모리에 로딩한다.</span></span><br><span class="line">            Class.forName(<span class="string">&quot;org.h2.Driver&quot;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 2.Connection 객체를 획득한다.</span></span><br><span class="line">            <span class="keyword">return</span> DriverManager.getConnection(<span class="string">&quot;jdbc:h2:tcp://localhost/~/test&quot;</span>,<span class="string">&quot;sa&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;            </span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// select 기능의 자원 해제</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(ResultSet rs, PreparedStatement stmt, Connection conn)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 6. Connection 연결 해제 close 순서 ResultSet-&gt; Statement -&gt; Connection</span></span><br><span class="line">           <span class="keyword">try</span>&#123;</span><br><span class="line">             <span class="keyword">if</span>(rs != <span class="keyword">null</span>)</span><br><span class="line">                 rs.close();</span><br><span class="line">         &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">             e.printStackTrace();</span><br><span class="line">         &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">             rs = <span class="keyword">null</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">             <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)</span><br><span class="line">                 stmt.close();</span><br><span class="line">         &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">             e.printStackTrace();</span><br><span class="line">         &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">             stmt = <span class="keyword">null</span>;</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">             <span class="keyword">if</span>(!conn.isClosed() &amp;&amp; conn != <span class="keyword">null</span>) <span class="comment">// 커넥션이 닫힌게 아니라면 이조건을 실행해라.</span></span><br><span class="line">                 conn.close();</span><br><span class="line">         &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">             e.printStackTrace();</span><br><span class="line">         &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">             conn = <span class="keyword">null</span>;</span><br><span class="line">         &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// select외의 기능의 자원 해제</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">close</span><span class="params">(PreparedStatement stmt, Connection conn)</span> </span>&#123;</span><br><span class="line">            <span class="comment">// 6. Connection 연결 해제 close 순서 Statement -&gt; Connection</span></span><br><span class="line"></span><br><span class="line">             <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">                 <span class="keyword">if</span>(stmt != <span class="keyword">null</span>)</span><br><span class="line">                     stmt.close();</span><br><span class="line">             &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                 e.printStackTrace();</span><br><span class="line">             &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                 stmt = <span class="keyword">null</span>;</span><br><span class="line">             &#125;</span><br><span class="line"></span><br><span class="line">             <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">                 <span class="keyword">if</span>(!conn.isClosed() &amp;&amp; conn != <span class="keyword">null</span>) <span class="comment">// 커넥션이 닫힌게 아니라면 이조건을 실행해라.</span></span><br><span class="line">                     conn.close();</span><br><span class="line">             &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">                 e.printStackTrace();</span><br><span class="line">             &#125;<span class="keyword">finally</span> &#123;</span><br><span class="line">                 conn = <span class="keyword">null</span>;</span><br><span class="line">             &#125;</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="DAO-VO를-이용한-리팩토링"><a href="#DAO-VO를-이용한-리팩토링" class="headerlink" title="DAO, VO를 이용한 리팩토링"></a>DAO, VO를 이용한 리팩토링</h3><ul>
<li>만약 인서트쿼리를 처리하고 하고 바로 조회를 하거나, 업데이트를 하고 바로 조회를 할려고 구현을 할 때<br>그냥 코드를 직접 넣으면 코드가 길어지고 지저분해 보이게 되고, JDBCUtil을 사용해도 번거로워지는 부분이 생긴다. 이 때 DAO를 만들면 된다.</li>
<li>boardDao만 작성 했을 때 문제점 <ul>
<li>문제1. 처음 볼 때 들어가는 값이 제목인지 컨텐트인지 모른다. 이 메소드를 들어가봐야 의미를 파악할 수 있다.</li>
<li>문제2. 파라미터의 타입과 순서만 맞으면 데이터가 잘 못 입력되어도 들어가게 된다. </li>
<li>에러가 뜨고 컴파일 오류가 뜨면 다행인데 안뜨고 잘 못 들어가면 문제가 된다.</li>
<li>그래서 VO도 함께 만들어서 데이터를 처리하면 된다.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">InertBoardTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. 글 등록 기능 처리</span></span><br><span class="line">        BoardDAO boardDAO = <span class="keyword">new</span> BoardDAO();</span><br><span class="line">        </span><br><span class="line">        BoardVO vo = <span class="keyword">new</span> BoardVO();</span><br><span class="line">        vo.setTitle(<span class="string">&quot;VO 테스트&quot;</span>);</span><br><span class="line">        vo.setTitle(<span class="string">&quot;테스터&quot;</span>);</span><br><span class="line">        vo.setTitle(<span class="string">&quot;VO 내용.....&quot;</span>);</span><br><span class="line">        </span><br><span class="line">        boardDAO.insertBoard(vo); </span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 글 목록 검색 기능 처리</span></span><br><span class="line">        boardDAO.getBoardList();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>DAO<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.rubypapper.biz.common.JDBCUtil;</span><br><span class="line"></span><br><span class="line"><span class="comment">// DAO(Data Access Object) 클래스</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoardDAO</span> </span>&#123;</span><br><span class="line">    <span class="comment">// JDBC 관련 변수 선언</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> Connection conn;</span><br><span class="line">    <span class="keyword">private</span> PreparedStatement stmt;</span><br><span class="line">    <span class="keyword">private</span> ResultSet rs;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// BOARD 테이블 관련 SQL 명령어</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BOARD_INSERT = <span class="string">&quot;INSERT INTO BOARD(SEQ, TITLE, WRITER, CONTENT) VALUES((SELECT NVL(MAX(SEQ),0)  + 1 FROM BOARD), ?, ?, ?)&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BOARD_UPDATE = <span class="string">&quot;UPDATE BOARD SET TITLE=?, CONTENT=? WHERE SEQ=?&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BOARD_DELETE = <span class="string">&quot;DELETE BOARD WHERE SEQ=?&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BOARD_GET = <span class="string">&quot;SELECT * FROM BOARD WHERE SEQ=?&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String BOARD_LIST = <span class="string">&quot;SELECT * FROM BOARD ORDER BY SEQ DESC&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// BOARD 테이블 관련 CRUD 기능의 메소드</span></span><br><span class="line">    <span class="comment">// 글 등록</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertBoard</span><span class="params">(BoardVO vo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = JDBCUtil.getConnection();</span><br><span class="line">            stmt = conn.prepareStatement(BOARD_INSERT); <span class="comment">// sql이 완성되지 않았다 ?로 넣었기 때문에.</span></span><br><span class="line">            </span><br><span class="line">            stmt.setString(<span class="number">1</span>, vo.getTitle()); <span class="comment">// sql 세팅 값을 넣어줌.</span></span><br><span class="line">            stmt.setString(<span class="number">2</span>, vo.getWriter());</span><br><span class="line">            stmt.setString(<span class="number">3</span>, vo.getContent());</span><br><span class="line">            </span><br><span class="line"><span class="comment">//            stmt.setString(1, title); // sql 세팅 값을 넣어줌.</span></span><br><span class="line"><span class="comment">//            stmt.setString(2, writer);</span></span><br><span class="line"><span class="comment">//            stmt.setString(3, content);</span></span><br><span class="line">            </span><br><span class="line">            stmt.executeUpdate();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(stmt, conn);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 글 수정</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateBoard</span><span class="params">(BoardVO vo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = JDBCUtil.getConnection();</span><br><span class="line">            stmt = conn.prepareStatement(BOARD_UPDATE);</span><br><span class="line">            </span><br><span class="line">            stmt.setString(<span class="number">1</span>, vo.getTitle()); <span class="comment">// sql 세팅 값을 넣어줌.</span></span><br><span class="line">            stmt.setString(<span class="number">2</span>, vo.getWriter());</span><br><span class="line">            stmt.setString(<span class="number">3</span>, vo.getContent());</span><br><span class="line">            </span><br><span class="line"><span class="comment">//            stmt.setString(1, title); // sql 세팅 값을 넣어줌.</span></span><br><span class="line"><span class="comment">//            stmt.setString(2, content);</span></span><br><span class="line"><span class="comment">//            stmt.setInt(3, seq);</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            stmt.executeUpdate();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(stmt, conn);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 글 삭제  나중에 유지보수할 때 int seq로작성했을때는 비밀번호도 필요하고그런 필요한 상황이 생겼을대 하나하나 넣어줘야 한다 그래서 vo를 통째로 넣는게 일관성 면에서도 좋다. 유지보수할 때 수정할 필요가 없어진다.</span></span><br><span class="line">    <span class="comment">// 지금은 메모리에 대한 걱정은 없어져서 vo를 통째로 넣어도 성능적으로 문제가 되지 않는다.</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">deleteBoard</span><span class="params">(BoardVO vo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = JDBCUtil.getConnection();</span><br><span class="line">            stmt = conn.prepareStatement(BOARD_DELETE);</span><br><span class="line">            </span><br><span class="line">            stmt.setInt(<span class="number">1</span>, vo.getSeq());</span><br><span class="line">            </span><br><span class="line">            stmt.executeUpdate();</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(stmt, conn);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 글 상세 조회</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BoardVO <span class="title">getBoard</span><span class="params">(BoardVO vo)</span> </span>&#123;</span><br><span class="line">        BoardVO board = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = JDBCUtil.getConnection();</span><br><span class="line">            stmt = conn.prepareStatement(BOARD_GET);</span><br><span class="line">            </span><br><span class="line">            stmt.setInt(<span class="number">1</span>, vo.getSeq());</span><br><span class="line">            </span><br><span class="line">            rs= stmt.executeQuery();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">                <span class="comment">// 검색 결과 한건을 BoardVO 객체를 매핑한다.</span></span><br><span class="line">                board = <span class="keyword">new</span> BoardVO();</span><br><span class="line">                board.setSeq(rs.getInt(<span class="string">&quot;SEQ&quot;</span>));</span><br><span class="line">                board.setTitle(rs.getString(<span class="string">&quot;TITLE&quot;</span>));</span><br><span class="line">                board.setWriter(rs.getString(<span class="string">&quot;WRITER&quot;</span>));</span><br><span class="line">                board.setContent(rs.getString(<span class="string">&quot;CONTENT&quot;</span>));</span><br><span class="line">                board.setRegDate(rs.getDate(<span class="string">&quot;REGDATE&quot;</span>));</span><br><span class="line">                board.setCnt(rs.getInt(<span class="string">&quot;CNT&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(rs, stmt, conn);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> board;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 글 목록 검색</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;BoardVO&gt; <span class="title">getBoardList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 비어있는 리스트 컬렉션을 생성한다.</span></span><br><span class="line">        List&lt;BoardVO&gt; boardList = <span class="keyword">new</span> ArrayList&lt;BoardVO&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            conn = JDBCUtil.getConnection();</span><br><span class="line">            stmt = conn.prepareStatement(BOARD_LIST);</span><br><span class="line">            </span><br><span class="line">            rs = stmt.executeQuery();</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">                <span class="comment">// 검색 결과 한 row당 하나의 BoardVO 객체를 매핑한다.                </span></span><br><span class="line">                BoardVO  board = <span class="keyword">new</span> BoardVO();</span><br><span class="line">                board.setSeq(rs.getInt(<span class="string">&quot;SEQ&quot;</span>));</span><br><span class="line">                board.setTitle(rs.getString(<span class="string">&quot;TITLE&quot;</span>));</span><br><span class="line">                board.setWriter(rs.getString(<span class="string">&quot;WRITER&quot;</span>));</span><br><span class="line">                board.setContent(rs.getString(<span class="string">&quot;CONTENT&quot;</span>));</span><br><span class="line">                board.setRegDate(rs.getDate(<span class="string">&quot;REGDATE&quot;</span>));</span><br><span class="line">                board.setCnt(rs.getInt(<span class="string">&quot;CNT&quot;</span>));</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// 검색 결과가 매핑된 BoardVO 객체를 리스트 컬렉션에 등록한다.</span></span><br><span class="line">                boardList.add(board);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            JDBCUtil.close(rs, stmt, conn);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 검색 결과가 저장된 리스트 컬렉션을 클라이언트로 리턴한다.</span></span><br><span class="line">        <span class="keyword">return</span> boardList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>VO<ul>
<li>VO, DTO 등의 클래스를 만들 때 새로온 변수를 추가하거나, getter/setter 메소드를 계속해서 생성해줘야 하고 변경되면 또 하나하나 변경해줘야 한다.<br>이러한 번거로움을 줄이기 위해서 <code>Lombok</code> 이라는 라이브러리를 사용하면 getter/setter같은 메소드를 자동으로 생성해준다.</li>
<li><code>@Data</code> 를 사용하면 필요한 모든 기능들을 포함해서 적용해준다.<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Date;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="comment">// VO(Value Object) 클래스</span></span><br><span class="line"><span class="comment">/*@Getter</span></span><br><span class="line"><span class="comment">@NoArgsConstructor</span></span><br><span class="line"><span class="comment">@AllArgsConstructor</span></span><br><span class="line"><span class="comment">@ToString</span></span><br><span class="line"><span class="comment">@EqualsAndHashCode*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BoardVO</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 테이블의 컬럼 이름(데이터 타입까지)과 동일한 멤버변수를 private로 선언한다.</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> seq;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String writer;</span><br><span class="line">    <span class="keyword">private</span> String content;</span><br><span class="line">    <span class="keyword">private</span> Date regDate;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> cnt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h3 id="중요"><a href="#중요" class="headerlink" title="중요!!!"></a>중요!!!</h3><ul>
<li>글 목록 조회나, 글 상세 조회 기능 같은 SELECT 쿼리를 사용해서 보여주는 기능들은 DAO에서 바로<br>출력하도록 하면 안되고, 객체를 넘겨줘서 이 메소드를 사용하는 클라이언트(메소드를 호출하는 메소드,객체)에서<br>결정해서 사용하도록 설계를 해야 한다!!  </li>
<li>select 안에서는 검색 결과를 처리하면 안된다. 메소드를 호출한 쪽에 검색 결과를 리턴 해줘야한다<br>그래서 클라이언트가 글 목록을 뿌릴지 데이터가 몇 개인지를 뿌릴지 결정하게 해야한다.</li>
</ul>
<h4 id="DAO의-글-상세조회-글-목록-조회-메소드"><a href="#DAO의-글-상세조회-글-목록-조회-메소드" class="headerlink" title="DAO의 글 상세조회, 글 목록 조회 메소드"></a>DAO의 글 상세조회, 글 목록 조회 메소드</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 글 상세 조회</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> BoardVO <span class="title">getBoard</span><span class="params">(BoardVO vo)</span> </span>&#123;</span><br><span class="line">    BoardVO board = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        conn = JDBCUtil.getConnection();</span><br><span class="line">        stmt = conn.prepareStatement(BOARD_GET);</span><br><span class="line">        </span><br><span class="line">        stmt.setInt(<span class="number">1</span>, vo.getSeq());</span><br><span class="line">        </span><br><span class="line">        rs= stmt.executeQuery();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (rs.next()) &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 검색 결과 한건을 BoardVO 객체를 매핑한다.</span></span><br><span class="line">            board = <span class="keyword">new</span> BoardVO();</span><br><span class="line">            board.setSeq(rs.getInt(<span class="string">&quot;SEQ&quot;</span>));</span><br><span class="line">            board.setTitle(rs.getString(<span class="string">&quot;TITLE&quot;</span>));</span><br><span class="line">            board.setWriter(rs.getString(<span class="string">&quot;WRITER&quot;</span>));</span><br><span class="line">            board.setContent(rs.getString(<span class="string">&quot;CONTENT&quot;</span>));</span><br><span class="line">            board.setRegDate(rs.getDate(<span class="string">&quot;REGDATE&quot;</span>));</span><br><span class="line">            board.setCnt(rs.getInt(<span class="string">&quot;CNT&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBCUtil.close(rs, stmt, conn);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> board;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 글 목록 검색</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;BoardVO&gt; <span class="title">getBoardList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 비어있는 리스트 컬렉션을 생성한다.</span></span><br><span class="line">    List&lt;BoardVO&gt; boardList = <span class="keyword">new</span> ArrayList&lt;BoardVO&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        conn = JDBCUtil.getConnection();</span><br><span class="line">        stmt = conn.prepareStatement(BOARD_LIST);</span><br><span class="line">        </span><br><span class="line">        rs = stmt.executeQuery();</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span> (rs.next()) &#123;</span><br><span class="line">            <span class="comment">// 검색 결과 한 row당 하나의 BoardVO 객체를 매핑한다.</span></span><br><span class="line">            </span><br><span class="line">            BoardVO  board = <span class="keyword">new</span> BoardVO();</span><br><span class="line">            board.setSeq(rs.getInt(<span class="string">&quot;SEQ&quot;</span>));</span><br><span class="line">            board.setTitle(rs.getString(<span class="string">&quot;TITLE&quot;</span>));</span><br><span class="line">            board.setWriter(rs.getString(<span class="string">&quot;WRITER&quot;</span>));</span><br><span class="line">            board.setContent(rs.getString(<span class="string">&quot;CONTENT&quot;</span>));</span><br><span class="line">            board.setRegDate(rs.getDate(<span class="string">&quot;REGDATE&quot;</span>));</span><br><span class="line">            board.setCnt(rs.getInt(<span class="string">&quot;CNT&quot;</span>));</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 검색 결과가 매핑된 BoardVO 객체를 리스트 컬렉션에 등록한다.</span></span><br><span class="line">            boardList.add(board);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">        JDBCUtil.close(rs, stmt, conn);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 검색 결과가 저장된 리스트 컬렉션을 클라이언트로 리턴한다.</span></span><br><span class="line">    <span class="keyword">return</span> boardList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="GetBoardTest-클라이언트"><a href="#GetBoardTest-클라이언트" class="headerlink" title="GetBoardTest(클라이언트)"></a>GetBoardTest(클라이언트)</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.rubypapper.biz.board;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"><span class="keyword">import</span> java.sql.ResultSet;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLException;</span><br><span class="line"><span class="keyword">import</span> java.sql.Statement;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GetBoardListTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. 글 목록 조회 기능 처리</span></span><br><span class="line">        BoardDAO boardDAO = <span class="keyword">new</span> BoardDAO();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// getBoardList() 메소드가 리턴한 글 목록을 원하는 형태로 사용한다.</span></span><br><span class="line">        List&lt;BoardVO&gt; boardList =boardDAO.getBoardList();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// select 기능의 메소드는 절대 return타입이 void이면 안된다 결과를 클라이언트에게 보내줘야 한다.</span></span><br><span class="line">        <span class="comment">// 어떻게 쓸지는 클라이언트가 결정해야지 dao가 결정하면 안된다!!! 중요!!!!!</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 1. CASE 글 목록을 출력</span></span><br><span class="line">        System.out.println(<span class="string">&quot;[ BOARD LIST ]&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span> (BoardVO board : boardList) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;----&gt;&quot;</span> + board.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 2. CASE</span></span><br><span class="line">        System.out.println(<span class="string">&quot;검색된 게시글 수 : &quot;</span> + boardList.size());</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>클라이언트 - 한 객체의 메소드(a)안에서 다른 객체가 가지고 있는 메소드(b)를 호출할때<br>b 입장에서 애를 사용하는 클라이언트는 a가 된다. <ul>
<li>객체에 한에서 클라이언트는 나를 사용하는 누군가를 클라이언트라한다.        </li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://limjoonchul.github.io/2020/11/21/Spring/JDBC/" data-id="ckhrac5jt002v8cu2e378e5mn" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/11/21/Spring/JSP/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Spring-JSP
        
      </div>
    </a>
  
  
    <a href="/2020/11/21/Spring/HTTP/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Spring-HTTP</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">November 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">August 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/11/21/Spring/Servlet/">Spring-Servlet</a>
          </li>
        
          <li>
            <a href="/2020/11/21/Spring/Pholymorphism/">Spring-Pholymorphism</a>
          </li>
        
          <li>
            <a href="/2020/11/21/Spring/JSP/">Spring-JSP</a>
          </li>
        
          <li>
            <a href="/2020/11/21/Spring/JDBC/">Spring-JDBC</a>
          </li>
        
          <li>
            <a href="/2020/11/21/Spring/HTTP/">Spring-HTTP</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2020 Facamp lim<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>